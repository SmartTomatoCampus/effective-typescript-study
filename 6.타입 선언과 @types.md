# 6.타입 선언과 @types

![327754-eng](https://user-images.githubusercontent.com/34502254/168100406-8929de59-6ccb-4f91-981f-f520586eaf70.png)

## 아이템 45

**devDependencies에 typescript와 @types 추가하기**

### dependencies

로컬환경의 프로젝트 런타임에 실행되는 라이브러리가 설치된 경로

### devDependencies

프로젝트를 개발하고 테스트하는데 사용되고 런타임에는 필요하지 않는 경우

### peerDependencies

런타임에 필요하긴 하지만 의존성을 직접 관리하지 않는 라이브러리들이 포함된다.

### 타입스크립트 자체 의존성을 고려해야한다.

- 팀원이 모두가 항상 동일한 버전을 설치한다는 보장이 없다.
- 프로젝트를 셋업할 때 별도의 단계가 추가된다.

1. 타입스크립트를 시스템 레벨로 설치하면 안된다.
2. 타입스크립트를 프로젝트의 devDependencies에 포함시키고 팀원 모두가 동일한 버전을 사용하도록 한다.
3. @types 의존성은 devDependencies에 포함되어야 한다.

## 아이템 46

타입 선언과 관련된 세 가지 버전 이해하기

타입스크립트에는 의존성에 관련되어 있다.

1. 라이브러리 버전, @types 버전, 타입스크립트 버전
2. 라이브러리를 업데이트하는 경우 해당 @types 역시 업데이트해야 한다.
3. 타입 선언을 라이브러리에 포함되는 것과 DefineitelyTyped 에 공개하는 것 사이의 장단점을 이해해야 한다.
4. 타입스크립트로 작성된 라이브러리라면 타입 선언을 자체적으로 포함하고 자바스크립트로 작성된 라이브러리라면 타입 선언을 DefinitelyTyped에 공개하는 것이 좋다.

## 아이템 47

**공개 API에 등장하는 모든 타입을 익스포트하기**

- 라이브러리의 함수의 타입이 지정이 되어있지 아니하다면, 그 해당 타입을 라이브러리에서 불러올수도 있고,
- 공개 메서드에 등장한 어떤 형태의 타입이든 익스포트를 하자.
- 어짜피 라이브러리 사요자가 추출할 수 잇으므로 익스포트하기 쉽게 만드는 것이 좋다.
## 아이템 48

**API 주석에 TSDoc 사용하기**

JSDoc 에는 `@param` `@returns` 같은 일반적인 규칙을 사용한다면, 타입스크립트 관점에서는 TSDoc 이라고 부른다.

그러나 TSDoc에서는 주석에 타입 정보를 명시하면 안된다.

JSDoc / TSDoc 형태의 주석을 달면 편집기가 주석 정보를 표시해준다.

```tsx
/**
* This _interface
* 1, x
* 2, y
* 3, z
*/

export interface Vector3D {
	x : number;
	y : number;
	z : number;
}
```

## 아이템 49

**콜백에서 this 에 대한 타입 제공하기**

 

this애 대한 바인딩 동작원리를 이해해야 한다 

콜백 함수에서  this 를 사용해야 한다면  타입정보를  명시해야한다.


## 아이템 50

**오버로딩 타입보다는 조건부 타입을 사용하기** 

- 타입을 반환하는 경우 제너릭을 사용하면 동작을 모델링 할수있다.
- T 가 string 부분 집합이면 반환 타입이 string 이다.
- 유니온  조건부 타입을 적용하면 조건부 타입의 유니온 분리되기 때문이다.
- 오버로딩 타입이 작성하기 쉽지만 조건부 타입은 개별 타입의 유니온으로  일반화하기때문에 타입이 더 정확해진다.
- 오버로딩 타입이 독립적으로 처리되는 반면, 조건부 타입은 타입 체커가 단일 표현식으로 받아들이기 때문에 유니온 문제를 해결 할 수 있다.
- 오버로딩 타입보다 조건부 타입을 사용하는 것이 좋다.
- 타입은 추가적인 오버로딩 없이 유니온 타입을 지원할 수 있습니다.

## 아이템 51

**의존성 분리를 위해 미러 타입 사용하기**

`@types/node` 에 의존하기 때문에 `@types/node` 는 devDependencies로 포함되어야 한다. 

각자가 필요한 모듈만 사용할 수 있도록 구조적 타이핑을 적용할 수 있습니다.

`@types/node` 있는 Buffer 선언을 사용하지 않고, 필요한 메서드와 속성만 별도로 작성할 수 있다.

- 필수 아닌 의존성을 분리할 때는 구조적 타이핑을 사용하면 됩니다.
- 공개한 라이브러리를 사용하는 자바스크립트 사용자가 `@types` 의존성을 가지지 않게 해야 한다.
- 웹 개발자가 NodeJS 관련된 의존성을 가지지 않게 해야한다.


## 아이템 52

**태스팅 타입의 함정에 주의하기**

타입 선언도 테스트를 거쳐야 한다. 그러나 타입 선언을 테스트하기는 매우 어렵다.

타입 선언에 대한 테스트 코드를 작성할 때 타입스크립트가 제공하는 도구를 사용하여 단언문으로 때우기 십상이지만 이런 방법에는 몇가지 문제가 있다.

궁극적으로 dtslint 또는 타입 시스템 외부에서 타입을 검사하는 유사한 도구를 사용한것이 더 안전하고 간단하다.

로대시와 언더스코어를 통해  타입을 검사할 수 있다.

- 타입을 테스트 할 때는 특히 함수 타입을 동일성과 할당 가능성의 차이점을 알고 있어야 한다.
- 콜백이 있는 함수를 테스트할 때, 콜백 매개변수의 추론된 타입을 체크해야 합니다.
- 또한 this가 API의 일부분이라면 역시 테스트 해야한다.
- 타입 관련된 테스트에서 any를 주의해야 한다. 더 염격한 테스트를 위해 dslint같은 도구를 사용하는 것이 좋다.
